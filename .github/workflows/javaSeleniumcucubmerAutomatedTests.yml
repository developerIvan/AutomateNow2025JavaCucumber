name: Run Selenium Tests with Headless Chrome #wrokflow name

on: # Defines the events that will trigger the GitHub action (push)
  schedule:
    - cron: '00 23 * * *'

  
jobs:
  test:
    runs-on: ubuntu-latest  
    env:
      browserName: chrome
      browserHeight: 1920
      browserWidth:  1080
          
          
    steps: # contains the actions/tasks to be executed
     - name: ðŸ›  Checkout repo
       uses: actions/checkout@v4
       
     - name: ðŸ”§ Set up JDK 17
       uses: actions/setup-java@v3
       with:
          distribution: 'temurin'
          java-version: '17'

     - name: ðŸš€ Set up Chrome
       uses: browser-actions/setup-chrome@v1

     - name: ðŸ— Install Maven dependencies
       run: mvn clean install -DskipTests
      
     - name: Env variables
       run: echo "This are the env variables $browserName $browserHeight and $browserWidth  This is the current dir $GITHUB_WORKSPACE" 

     
       
     - name: Create env file  
       run: 
          touch .env
          echo browserName=$browserName >> .env
          echo browserHeight=$browserHeight >> .env
          echo browserWidth=$browserWidth  >> .env
          cat .env
          
     - name: file list
       run:  pwd && ls -la     
       
     - name: ðŸ§ª Run Tests
       run: mvn test

     - name: ðŸ“Š Generate Allure Report
       if: always()
       run: mvn allure:report

     - name: ðŸ“¤ Upload Allure Results
       if: always()
       uses: actions/upload-artifact@v4
       with:
          name: allure-results
          path: target/allure-results
     - name: Upload log file
       if: always()
       uses: actions/upload-artifact@v4
       with:
         name: automation.log
         path: /logs/automation.log    

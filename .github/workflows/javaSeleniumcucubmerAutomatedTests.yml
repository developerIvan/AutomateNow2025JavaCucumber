name: Run Selenium Tests with Headless Chrome #wrokflow name

on: # Defines the events that will trigger the GitHub action (push)
  schedule:
    - cron: '30 18 * * *'
env:
  BROWSERNAME: chrome
jobs:
  test:
    runs-on: ubuntu-latest  
    env:
      BROWSERHEIGTH: 1920
      BROWSERWIDTH:  1080
          
          
    steps: # contains the actions/tasks to be executed
     - name: 🛠 Checkout repo
       uses: actions/checkout@v4
       
     - name: 🔧 Set up JDK 17
       uses: actions/setup-java@v3
       with:
          distribution: 'temurin'
          java-version: '17'

     - name: 🚀 Set up Chrome
       uses: browser-actions/setup-chrome@v1

     - name: 🏗 Install Maven dependencies
       run: mvn clean install -DskipTests
      
     - name: Env variables
       run: echo "This are the env variables $BROWSERNAME $BROWSERHEIGTH and $BROWSERWIDTH  This is the current dir $GITHUB_WORKSPACE" 

     - name: file list
       run:  ls 
       
     - name: Create env file  
       run: 
          touch .env
          echo browserName=$BROWSERNAME >> .env
          echo browserHeight=$BROWSERHEIGTH >> .env
          echo browserWidth=$BROWSERWIDTH  >> .env
          cat .env  
       
     - name: 🧪 Run Tests
       run: mvn test

     - name: 📊 Generate Allure Report
       run: mvn allure:report

     - name: 📤 Upload Allure Results
       uses: actions/upload-artifact@v4
       with:
          name: allure-results
          path: target/allure-results
